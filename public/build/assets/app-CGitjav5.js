document.addEventListener("DOMContentLoaded",()=>{const c="http://127.0.0.1:8000",t=document,s=t.querySelector("button#Auth"),l=t.querySelector("input#email"),u=200;let d=null,f=t.querySelector("title").innerHTML;function m(e){if(e==="email is required.")return"ایمیل اجباری است.";if(e==="email must be type email.")return"ورودی باید از نوع ایمیل باشد."}function p(e,i,o){e.classList.add("invalid");let n="";try{t.querySelector(".error-box").remove()}catch{}switch(n+='<div class="error-box mt-1">',i){case"email":o.email.forEach(function(r){r=m(r),n+=`<span class="error text-[#FF5C00] mt-1 block">${r}</span>`});break;default:console.error("not found errorName")}n+="</div>",e.insertAdjacentHTML("afterend",n)}function v(e="all"){e!=="all"?e.classList.remove("invalid"):t.querySelector(".invalid").classList.remove("invalid");try{t.querySelector(".error-box").style.display="none"}catch{}}function y(e){e.disabled=!0,e.innerHTML=`<img id="loading" src='${c+"/assets/images/loading.png"}' alt=''>`}function h(e,i,o,n,r){y(e);let a=new XMLHttpRequest;a.onload=()=>{i(a)},a.open(o,n),a.setRequestHeader("Content-type","application/json"),setTimeout(()=>{a.send(JSON.stringify(r))},u)}t.addEventListener("visibilitychange",function(){t.visibilityState==="hidden"?t.title="کجا رفتی؟ بیا😒":t.title=f}),s.addEventListener("click",function(){d!==l.value&&(h(s,function(e){if(s.disabled=!1,JSON.parse(e.response).status==="Success")s.innerHTML="مرحله بعد",v();else{s.innerHTML="مرحله بعد";let i=JSON.parse(e.response).data.errors;p(l,"email",i)}},"POST",c+"/api/v1/auth",{email:l.value}),d=l.value)})});
